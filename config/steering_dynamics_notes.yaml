# ============================================================
# URSULA Steering Dynamics - Gazebo Tuning Guide
# ============================================================
#
# Problem: URSULA turns well on the spot but struggles to
# adjust heading whilst moving forwards.
#
# Root cause: Skid-steer robots resist lateral motion by
# design. The wheels have to physically skid sideways to
# change direction. The key variables are friction coefficients
# and the turn_multiplier in the serial bridge.
#
# ============================================================
# WHAT TO ADJUST IN SIMULATION
# ============================================================
#
# In gazebo_plugins.xacro, each wheel has two friction params:
#
#   mu1 = friction in the rolling direction (forward/back)
#   mu2 = friction in the lateral direction (sideways)
#
# Current values:
#   mu1: 0.9   (high rolling friction - good grip forwards)
#   mu2: 0.4   (lower lateral - allows skidding to turn)
#
# To make turning-while-moving EASIER:
#   → Lower mu2 toward 0.2-0.3
#   → Risk: robot becomes squirrelly, slides around corners
#
# To make turning-while-moving HARDER (more like current real behaviour):
#   → Raise mu2 toward 0.6-0.8
#   → This replicates heavy carpets, sticky floors, etc.
#
# ============================================================
# WHAT TO ADJUST IN THE SERIAL BRIDGE
# ============================================================
#
# turn_multiplier in serial_bridge_params.yaml (currently 4.5)
#
# This amplifies the angular velocity component of cmd_vel
# before converting to left/right PWM. A higher value means
# a larger speed difference between left and right wheels
# for the same joystick angular input.
#
# If the robot turns fine on the spot but not while moving,
# the issue is that at speed the wheel velocity differential
# is too small relative to the forward velocity to overcome
# friction and change heading.
#
# Try increasing turn_multiplier to 6.0-8.0 for faster
# heading correction while moving. Monitor for instability
# (oscillating left/right) which means it is too high.
#
# ============================================================
# CMD_VEL TUNING
# ============================================================
#
# In controller_teleop.yaml:
#
#   scale_linear.x: 0.1      ← very conservative (10 cm/s max)
#   scale_angular.yaw: 0.10  ← also conservative
#
# For steering dynamics testing, try:
#   scale_linear.x: 0.3      ← ~30 cm/s, more realistic speed
#   scale_angular.yaw: 0.4   ← enough to make meaningful heading changes
#
# The current scales are so low that the robot barely generates
# enough wheel speed differential to overcome static friction
# during a turn. This is likely a major contributor to poor
# steering-while-moving performance on the real robot.
#
# ============================================================
# SUGGESTED SIMULATION TEST PROCEDURE
# ============================================================
#
# 1. Spawn URSULA at the south end of the maze (default spawn)
# 2. Drive north along the central corridor
# 3. Try to nudge left/right around the red box obstacles
#    at x=±2.5, y=0
# 4. Observe: does the robot correct its heading smoothly,
#    or does it need to slow/stop to turn?
# 5. Adjust mu2 and turn_multiplier, rebuild, repeat
# 6. Once satisfied in simulation, transfer values to real robot
#    and test in a safe open space first
#
# ============================================================
# QUICK REFERENCE: FILE → PARAMETER → EFFECT
# ============================================================
#
#   gazebo_plugins.xacro   mu2              Lateral friction
#   serial_bridge_params   turn_multiplier  Angular amplification
#   controller_teleop      scale_linear.x   Max forward speed
#   controller_teleop      scale_angular    Max turn rate input
#   nav2_params            desired_linear_vel  Nav2 cruise speed
#   nav2_params            rotate_to_heading   Nav2 turn strategy
